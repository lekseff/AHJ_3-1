(()=>{"use strict";function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}new(function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.board=e.querySelector("#board"),this.images=e.querySelector("#goblin"),this.killed=e.querySelector("#killed"),this.missing=e.querySelector("#missing"),this.popup=e.querySelector("#popup"),this.boardSize=4,this.currentPosition=null,this.killedScore=null,this.missingScore=null,this.maxMissingScore=10,this.timeoutId=null,this.interval=null,this.renderBoard(),this.registerEvents()}var i,n,s;return i=t,n=[{key:"registerEvents",value:function(){var e=this.popup.querySelector(".popup__button");this.board.addEventListener("click",this.eventHandler.bind(this)),e.addEventListener("click",this.closePopup.bind(this))}},{key:"startGame",value:function(){this.killed.textContent=0,this.missing.textContent=0,this.killedScore=0,this.missingScore=0,this.interval=1e3,this.nextStep()}},{key:"renderBoard",value:function(){for(var e=0;e<Math.pow(this.boardSize,2);e+=1)this.board.append(t.createCell())}},{key:"eventHandler",value:function(e){"IMG"===e.target.tagName?(this.killedScore+=1,this.killed.textContent=this.killedScore,this.gameSpeed(),this.nextStep()):(this.missingScore+=1,this.missing.textContent=this.missingScore,this.checkingEndGame())}},{key:"closePopup",value:function(){this.popup.classList.add("popup__hidden"),this.startGame()}},{key:"nextStep",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.timeoutId&&clearTimeout(this.timeoutId),t){var i=this.randomPosition();this.board.children[i].append(this.images),this.timeoutId=setTimeout((function(){e.nextStep()}),this.interval)}}},{key:"checkingEndGame",value:function(){return this.missingScore<this.maxMissingScore||(this.nextStep(!1),this.popup.querySelector(".popup__score").textContent="Счёт: ".concat(this.killedScore),this.popup.classList.remove("popup__hidden"),!1)}},{key:"gameSpeed",value:function(){this.killedScore>5&&this.killedScore<10&&(this.interval=850),this.killedScore>=10&&this.killedScore<14&&(this.interval=750),this.killedScore>=14&&this.killedScore<20&&(this.interval=650),this.killedScore>=20&&(this.interval=550)}},{key:"randomPosition",value:function(){for(var e=Math.pow(this.boardSize,2),t=Math.floor(Math.random()*e);t===this.currentPosition;)t=Math.floor(Math.random()*e);return this.currentPosition=t,t}}],s=[{key:"createCell",value:function(){var e=document.createElement("div");return e.classList.add("game__board-cell"),e}}],n&&e(i.prototype,n),s&&e(i,s),Object.defineProperty(i,"prototype",{writable:!1}),t}())(document.querySelector("#game")).startGame()})();